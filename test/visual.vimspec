scriptencoding utf-8
Describe visual

    Before all
        let lines = [
        \     '1.asterisk 2.asterisk 3.asterisk'
        \   , '4.Asterisk 5.AsteRisK 6.Asterisk'
        \   , ''
        \   , '7.アスタリスク 8.アスタリスクです 9.アスタリスク?'
        \   , '.* .* .*'
        \   , '.* asterisk asterisk'
        \   , '".*" ".*" ''asterisk'' ''asterisk'''
        \   , '"''.*" "''.*" "aste"risk" "aste"risk"'
        \ ]
        call g:Add_lines(lines)
    End

    Before each
        :1
        normal! 2l
        let @/ = ''
    End

    After all
        :1,$ delete
    End

    Context *
        It search forward with \<\>
            normal viw*
            Assert Equals(@/, '\V\<asterisk\>')
        End
        It search forward only with \<
            normal v2l*
            Assert Equals(@/, '\V\<ast')
        End
        It search forward only with \>
            normal 2lve*
            Assert Equals(@/, '\Vterisk\>')
        End
    End

    Context multibyte *
        It handle left keyword
            normal 3jv2l*
            Assert Equals(@/, '\V\<アスタ')
        End
        It handle right keyword
            normal 3jev2h*
            Assert Equals(@/, '\Vリスク\>')
        End
        It handle left and right keyword
            normal 3jve*
            Assert Equals(@/, '\V\<アスタリスク\>')
        End
        It is irrelabant with keyword
            normal 3jlv2l*
            Assert Equals(@/, '\Vスタリ')
        End
        It handle one character selection
            normal 3jv*
            Assert Equals(@/, '\V\<ア')
        End
    End

    Context regular expression handling
        It correctly escape regex
          normal! 4j0
          normal vl*
          Assert Equals(@/, '\V.*')
        End
    End

    Context handling quotes
        It correctly handle double quotes with z*
          normal! 6j0
          normal viWz*
          Assert Equals(@/, '\V".*"')
        End
        It correctly handle double quotes with *
          normal! 6j0
          normal viW*
          Assert Equals(@/, '\V".*"')
        End
        It correctly handle single quotes with z*
          normal! 6j02W
          normal viWz*
          Assert Equals(@/, '\V''asterisk''')
        End
    End


End
